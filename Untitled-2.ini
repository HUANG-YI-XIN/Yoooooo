#include <Servo.h>

// 定義引腳
const int trigPin = 5;
const int echoPin = 6;
const int ledPin = 3;
const int servoPin = 4;

// 創建伺服馬達物件
Servo myServo;

void setup() {
  // 初始化引腳模式
  pinMode(trigPin, OUTPUT);
  pinMode(echoPin, INPUT);
  pinMode(ledPin, OUTPUT);

  // 初始化伺服馬達
  myServo.attach(servoPin);
  myServo.write(0); // 初始位置為 0 度

  // 初始化序列監視器
  Serial.begin(9600);
}

void loop() {
  // 發送超音波
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  // 接收回波時間
  long duration = pulseIn(echoPin, HIGH);

  // 計算距離（單位：公分）
  float distance = duration * 0.034 / 2;

  // 在序列監視器中輸出距離
  Serial.print("Distance: ");
  Serial.print(distance);
  Serial.println(" cm");

  // 根據距離控制 LED 和伺服馬達
  if (distance < 10) {
    digitalWrite(ledPin, HIGH); // LED 亮
    myServo.write(90);          // 伺服馬達轉到 90 度
  } else {
    digitalWrite(ledPin, LOW);  // LED 滅
    myServo.write(0);           // 伺服馬達回到 0 度
  }

  delay(100); // 延遲 100 毫秒
}